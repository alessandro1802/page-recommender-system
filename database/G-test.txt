https://en.wikipedia.org/wiki/G-test
In statistics, G-tests are likelihood-ratio or maximum likelihood statistical significance tests that are increasingly being used in situations where chi-squared tests were previously recommended.[1] The general formula for G is where      O  i   ≥ 0   {\textstyle O_{i}\geq 0}   is the observed count in a cell,      E  i   > 0   {\textstyle E_{i}>0}   is the expected count under the null hypothesis,     ln   {\textstyle \ln }   denotes the natural logarithm, and the sum is taken over all non-empty cells. Furthermore, the total observed count should be equal to the total expected count:G-tests have been recommended at least since the 1981 edition of Biometry, a statistics textbook by Robert R. Sokal and F. James Rohlf.[2] We can derive the value of the G-test from the log-likelihood ratio test where the underlying model is a multinomial model. Suppose we had a sample     x = (  x  1   , … ,  x  m   )   {\textstyle x=(x_{1},\ldots ,x_{m})}   where each      x  i     {\textstyle x_{i}}   is the number of times that an object of type     i   {\textstyle i}   was observed. Furthermore, let     n =  ∑  i = 1   m    x  i     {\textstyle n=\sum _{i=1}^{m}x_{i}}   be the total number of objects observed. If we assume that the underlying model is multinomial, then the test statistic is defined by        G    =    − 2  ∑  i = 1   m    O  i   ln ⁡  (    E  i    O  i     )        =   2  ∑  i = 1   m    O  i   ln ⁡  (    O  i    E  i     )        {\displaystyle {\begin{alignedat}{2}G&=&\;-2\sum _{i=1}^{m}O_{i}\ln \left({\frac {E_{i}}{O_{i}}}\right)\\&=&2\sum _{i=1}^{m}O_{i}\ln \left({\frac {O_{i}}{E_{i}}}\right)\end{alignedat}}}   Heuristically, one can imagine        O  i       {\displaystyle ~O_{i}~}   as continuous and approaching zero, in which case        O  i   ln ⁡  O  i   → 0   ,   {\displaystyle ~O_{i}\ln O_{i}\to 0~,}   and terms with zero observations can simply be dropped. However the expected count in each cell must be strictly greater than zero for each cell (       E  i   > 0   ∀  i     {\displaystyle ~E_{i}>0~\forall \,i~}  ) to apply the method. Given the null hypothesis that the observed frequencies result from random sampling from a distribution with the given expected frequencies, the distribution of G is approximately a chi-squared distribution, with the same number of degrees of freedom as in the corresponding chi-squared test. For very small samples the multinomial test for goodness of fit, and Fisher's exact test for contingency tables, or even Bayesian hypothesis selection are preferable to the G-test.[3] McDonald recommends to always use an exact test (exact test of goodness-of-fit, Fisher's exact test) if the total sample size is less than 1 000 . The commonly used chi-squared tests for goodness of fit to a distribution and for independence in contingency tables are in fact approximations of the log-likelihood ratio on which the G-tests are based.[4] The general formula for Pearson's chi-squared test statistic is The approximation of G by chi squared is obtained by a second order Taylor expansion of the natural logarithm around 1. To see this consider  and let      O  i   =  E  i   +  δ  i     {\displaystyle O_{i}=E_{i}+\delta _{i}}   with      ∑  i    δ  i   = 0   ,   {\displaystyle \sum _{i}\delta _{i}=0~,}   so that the total number of counts remains the same. Upon substitution we find, A Taylor expansion around     1 +    δ  i    E  i       {\displaystyle 1+{\frac {\delta _{i}}{E_{i}}}}   can be performed using     ln ⁡ ( 1 + x ) = x −   1 2    x  2   +   O   (  x  3   )   {\displaystyle \ln(1+x)=x-{\frac {1}{2}}x^{2}+{\mathcal {O}}(x^{3})}  . The result is Now, using the fact that        ∑  i    δ  i   = 0     {\displaystyle ~\sum _{i}\delta _{i}=0~}   and        δ  i   =  O  i   −  E  i     ,   {\displaystyle ~\delta _{i}=O_{i}-E_{i}~,}   we can write the result, This shows that     G ≈  χ  2     {\displaystyle G\approx \chi ^{2}}   when the observed counts        O  i       {\displaystyle ~O_{i}~}   are close to the expected counts        E  i     .   {\displaystyle ~E_{i}~.}   When this difference is large, however, the        χ  2       {\displaystyle ~\chi ^{2}~}   approximation begins to break down. Here, the effects of outliers in data will be more pronounced, and this explains the why        χ  2       {\displaystyle ~\chi ^{2}~}   tests fail in situations with little data.  For samples of a reasonable size, the G-test and the chi-squared test will lead to the same conclusions. However, the approximation to the theoretical chi-squared distribution for the G-test is better than for the Pearson's chi-squared test.[5] In cases where        O  i   > 2 ⋅  E  i       {\displaystyle ~O_{i}>2\cdot E_{i}~}   for some cell case the G-test is always better than the chi-squared test.[citation needed] For testing goodness-of-fit the G-test is infinitely more efficient than the chi squared test in the sense of Bahadur, but the two tests are equally efficient in the sense of Pitman or in the sense of Hodges and Lehmann.[6][7] The G-test statistic is proportional to the Kullback–Leibler divergence of the theoretical distribution from the empirical distribution: where N is the total number of observations and      o  i     {\displaystyle o_{i}}   and      e  i     {\displaystyle e_{i}}   are the empirical and theoretical frequencies, respectively. For analysis of contingency tables the value of G can also be expressed in terms of mutual information. Let Then G can be expressed in several alternative forms: where the entropy of a discrete random variable     X    {\displaystyle X\,}   is defined as and where is the mutual information between the row vector r and the column vector c of the contingency table. It can also be shown[citation needed] that the inverse document frequency weighting commonly used for text retrieval is an approximation of G applicable when the row sum for the query is much smaller than the row sum for the remainder of the corpus.  Similarly, the result of Bayesian inference applied to a choice of single multinomial distribution for all rows of the contingency table taken together versus the more general alternative of a separate multinomial per row produces results very similar to the G statistic.[citation needed]